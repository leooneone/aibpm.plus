import{c as rt}from"./_commonjsHelpers.042e6b4d.js";import{r as it}from"./vue.runtime.esm-bundler.2c939456.js";function st(I,X){for(var N=0;N<X.length;N++){const z=X[N];if(typeof z!="string"&&!Array.isArray(z)){for(const U in z)if(U!=="default"&&!(U in I)){const A=Object.getOwnPropertyDescriptor(z,U);A&&Object.defineProperty(I,U,A.get?A:{enumerable:!0,get:()=>z[U]})}}}return Object.freeze(Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}))}var q={},ct={get exports(){return q},set exports(I){q=I}};(function(I,X){(function(N,z){I.exports=z(it)})(typeof self<"u"?self:rt,function(N){return function(){var z={9662:function(n,s,t){var e=t(7854),o=t(614),r=t(6330),i=e.TypeError;n.exports=function(a){if(o(a))return a;throw i(r(a)+" is not a function")}},6077:function(n,s,t){var e=t(7854),o=t(614),r=e.String,i=e.TypeError;n.exports=function(a){if(typeof a=="object"||o(a))return a;throw i("Can't set "+r(a)+" as a prototype")}},9670:function(n,s,t){var e=t(7854),o=t(111),r=e.String,i=e.TypeError;n.exports=function(a){if(o(a))return a;throw i(r(a)+" is not an object")}},4019:function(n){n.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},260:function(n,s,t){var e,o,r,i=t(4019),a=t(9781),u=t(7854),l=t(614),p=t(111),d=t(2597),h=t(648),m=t(6330),g=t(8880),x=t(1320),_=t(3070).f,k=t(7976),T=t(9518),E=t(7674),B=t(5112),F=t(9711),O=u.Int8Array,D=O&&O.prototype,j=u.Uint8ClampedArray,y=j&&j.prototype,R=O&&T(O),M=D&&T(D),J=Object.prototype,H=u.TypeError,K=B("toStringTag"),Y=F("TYPED_ARRAY_TAG"),L=F("TYPED_ARRAY_CONSTRUCTOR"),C=i&&!!E&&h(u.opera)!=="Opera",W=!1,P={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},$={BigInt64Array:8,BigUint64Array:8},Q=function(c){if(!p(c))return!1;var f=h(c);return f==="DataView"||d(P,f)||d($,f)},Z=function(c){if(!p(c))return!1;var f=h(c);return d(P,f)||d($,f)},nt=function(c){if(Z(c))return c;throw H("Target is not a typed array")},tt=function(c){if(l(c)&&(!E||k(R,c)))return c;throw H(m(c)+" is not a typed array constructor")},et=function(c,f,v){if(a){if(v)for(var S in P){var w=u[S];if(w&&d(w.prototype,c))try{delete w.prototype[c]}catch{}}M[c]&&!v||x(M,c,v?f:C&&D[c]||f)}},b=function(c,f,v){var S,w;if(a){if(E){if(v){for(S in P)if(w=u[S],w&&d(w,c))try{delete w[c]}catch{}}if(R[c]&&!v)return;try{return x(R,c,v?f:C&&R[c]||f)}catch{}}for(S in P)w=u[S],!w||w[c]&&!v||x(w,c,f)}};for(e in P)o=u[e],r=o&&o.prototype,r?g(r,L,o):C=!1;for(e in $)o=u[e],r=o&&o.prototype,r&&g(r,L,o);if((!C||!l(R)||R===Function.prototype)&&(R=function(){throw H("Incorrect invocation")},C))for(e in P)u[e]&&E(u[e],R);if((!C||!M||M===J)&&(M=R.prototype,C))for(e in P)u[e]&&E(u[e].prototype,M);if(C&&T(y)!==M&&E(y,M),a&&!d(M,K))for(e in W=!0,_(M,K,{get:function(){return p(this)?this[Y]:void 0}}),P)u[e]&&g(u[e],Y,e);n.exports={NATIVE_ARRAY_BUFFER_VIEWS:C,TYPED_ARRAY_CONSTRUCTOR:L,TYPED_ARRAY_TAG:W&&Y,aTypedArray:nt,aTypedArrayConstructor:tt,exportTypedArrayMethod:et,exportTypedArrayStaticMethod:b,isView:Q,isTypedArray:Z,TypedArray:R,TypedArrayPrototype:M}},9671:function(n,s,t){var e=t(9974),o=t(8361),r=t(7908),i=t(6244),a=function(u){var l=u==1;return function(p,d,h){for(var m,g,x=r(p),_=o(x),k=e(d,h),T=i(_);T-- >0;)if(m=_[T],g=k(m,T,x),g)switch(u){case 0:return m;case 1:return T}return l?-1:void 0}};n.exports={findLast:a(0),findLastIndex:a(1)}},4326:function(n,s,t){var e=t(1702),o=e({}.toString),r=e("".slice);n.exports=function(i){return r(o(i),8,-1)}},648:function(n,s,t){var e=t(7854),o=t(1694),r=t(614),i=t(4326),a=t(5112),u=a("toStringTag"),l=e.Object,p=i(function(){return arguments}())=="Arguments",d=function(h,m){try{return h[m]}catch{}};n.exports=o?i:function(h){var m,g,x;return h===void 0?"Undefined":h===null?"Null":typeof(g=d(m=l(h),u))=="string"?g:p?i(m):(x=i(m))=="Object"&&r(m.callee)?"Arguments":x}},9920:function(n,s,t){var e=t(7293);n.exports=!e(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},8880:function(n,s,t){var e=t(9781),o=t(3070),r=t(9114);n.exports=e?function(i,a,u){return o.f(i,a,r(1,u))}:function(i,a,u){return i[a]=u,i}},9114:function(n){n.exports=function(s,t){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:t}}},9781:function(n,s,t){var e=t(7293);n.exports=!e(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:function(n,s,t){var e=t(7854),o=t(111),r=e.document,i=o(r)&&o(r.createElement);n.exports=function(a){return i?r.createElement(a):{}}},8113:function(n,s,t){var e=t(5005);n.exports=e("navigator","userAgent")||""},7392:function(n,s,t){var e,o,r=t(7854),i=t(8113),a=r.process,u=r.Deno,l=a&&a.versions||u&&u.version,p=l&&l.v8;p&&(e=p.split("."),o=e[0]>0&&e[0]<4?1:+(e[0]+e[1])),!o&&i&&(e=i.match(/Edge\/(\d+)/),(!e||e[1]>=74)&&(e=i.match(/Chrome\/(\d+)/),e&&(o=+e[1]))),n.exports=o},7293:function(n){n.exports=function(s){try{return!!s()}catch{return!0}}},9974:function(n,s,t){var e=t(1702),o=t(9662),r=e(e.bind);n.exports=function(i,a){return o(i),a===void 0?i:r?r(i,a):function(){return i.apply(a,arguments)}}},6916:function(n){var s=Function.prototype.call;n.exports=s.bind?s.bind(s):function(){return s.apply(s,arguments)}},6530:function(n,s,t){var e=t(9781),o=t(2597),r=Function.prototype,i=e&&Object.getOwnPropertyDescriptor,a=o(r,"name"),u=a&&function(){}.name==="something",l=a&&(!e||e&&i(r,"name").configurable);n.exports={EXISTS:a,PROPER:u,CONFIGURABLE:l}},1702:function(n){var s=Function.prototype,t=s.bind,e=s.call,o=t&&t.bind(e);n.exports=t?function(r){return r&&o(e,r)}:function(r){return r&&function(){return e.apply(r,arguments)}}},5005:function(n,s,t){var e=t(7854),o=t(614),r=function(i){return o(i)?i:void 0};n.exports=function(i,a){return arguments.length<2?r(e[i]):e[i]&&e[i][a]}},8173:function(n,s,t){var e=t(9662);n.exports=function(o,r){var i=o[r];return i==null?void 0:e(i)}},7854:function(n,s,t){var e=function(o){return o&&o.Math==Math&&o};n.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof t.g=="object"&&t.g)||function(){return this}()||Function("return this")()},2597:function(n,s,t){var e=t(1702),o=t(7908),r=e({}.hasOwnProperty);n.exports=Object.hasOwn||function(i,a){return r(o(i),a)}},3501:function(n){n.exports={}},4664:function(n,s,t){var e=t(9781),o=t(7293),r=t(317);n.exports=!e&&!o(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!=7})},8361:function(n,s,t){var e=t(7854),o=t(1702),r=t(7293),i=t(4326),a=e.Object,u=o("".split);n.exports=r(function(){return!a("z").propertyIsEnumerable(0)})?function(l){return i(l)=="String"?u(l,""):a(l)}:a},2788:function(n,s,t){var e=t(1702),o=t(614),r=t(5465),i=e(Function.toString);o(r.inspectSource)||(r.inspectSource=function(a){return i(a)}),n.exports=r.inspectSource},9909:function(n,s,t){var e,o,r,i=t(8536),a=t(7854),u=t(1702),l=t(111),p=t(8880),d=t(2597),h=t(5465),m=t(6200),g=t(3501),x="Object already initialized",_=a.TypeError,k=a.WeakMap,T=function(y){return r(y)?o(y):e(y,{})},E=function(y){return function(R){var M;if(!l(R)||(M=o(R)).type!==y)throw _("Incompatible receiver, "+y+" required");return M}};if(i||h.state){var B=h.state||(h.state=new k),F=u(B.get),O=u(B.has),D=u(B.set);e=function(y,R){if(O(B,y))throw new _(x);return R.facade=y,D(B,y,R),R},o=function(y){return F(B,y)||{}},r=function(y){return O(B,y)}}else{var j=m("state");g[j]=!0,e=function(y,R){if(d(y,j))throw new _(x);return R.facade=y,p(y,j,R),R},o=function(y){return d(y,j)?y[j]:{}},r=function(y){return d(y,j)}}n.exports={set:e,get:o,has:r,enforce:T,getterFor:E}},614:function(n){n.exports=function(s){return typeof s=="function"}},111:function(n,s,t){var e=t(614);n.exports=function(o){return typeof o=="object"?o!==null:e(o)}},1913:function(n){n.exports=!1},2190:function(n,s,t){var e=t(7854),o=t(5005),r=t(614),i=t(7976),a=t(3307),u=e.Object;n.exports=a?function(l){return typeof l=="symbol"}:function(l){var p=o("Symbol");return r(p)&&i(p.prototype,u(l))}},6244:function(n,s,t){var e=t(7466);n.exports=function(o){return e(o.length)}},133:function(n,s,t){var e=t(7392),o=t(7293);n.exports=!!Object.getOwnPropertySymbols&&!o(function(){var r=Symbol();return!String(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&e&&e<41})},8536:function(n,s,t){var e=t(7854),o=t(614),r=t(2788),i=e.WeakMap;n.exports=o(i)&&/native code/.test(r(i))},3070:function(n,s,t){var e=t(7854),o=t(9781),r=t(4664),i=t(9670),a=t(4948),u=e.TypeError,l=Object.defineProperty;s.f=o?l:function(p,d,h){if(i(p),d=a(d),i(h),r)try{return l(p,d,h)}catch{}if("get"in h||"set"in h)throw u("Accessors not supported");return"value"in h&&(p[d]=h.value),p}},9518:function(n,s,t){var e=t(7854),o=t(2597),r=t(614),i=t(7908),a=t(6200),u=t(9920),l=a("IE_PROTO"),p=e.Object,d=p.prototype;n.exports=u?p.getPrototypeOf:function(h){var m=i(h);if(o(m,l))return m[l];var g=m.constructor;return r(g)&&m instanceof g?g.prototype:m instanceof p?d:null}},7976:function(n,s,t){var e=t(1702);n.exports=e({}.isPrototypeOf)},7674:function(n,s,t){var e=t(1702),o=t(9670),r=t(6077);n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var i,a=!1,u={};try{i=e(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),i(u,[]),a=u instanceof Array}catch{}return function(l,p){return o(l),r(p),a?i(l,p):l.__proto__=p,l}}():void 0)},2140:function(n,s,t){var e=t(7854),o=t(6916),r=t(614),i=t(111),a=e.TypeError;n.exports=function(u,l){var p,d;if(l==="string"&&r(p=u.toString)&&!i(d=o(p,u))||r(p=u.valueOf)&&!i(d=o(p,u))||l!=="string"&&r(p=u.toString)&&!i(d=o(p,u)))return d;throw a("Can't convert object to primitive value")}},1320:function(n,s,t){var e=t(7854),o=t(614),r=t(2597),i=t(8880),a=t(3505),u=t(2788),l=t(9909),p=t(6530).CONFIGURABLE,d=l.get,h=l.enforce,m=String(String).split("String");(n.exports=function(g,x,_,k){var T,E=!!k&&!!k.unsafe,B=!!k&&!!k.enumerable,F=!!k&&!!k.noTargetGet,O=k&&k.name!==void 0?k.name:x;o(_)&&(String(O).slice(0,7)==="Symbol("&&(O="["+String(O).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!r(_,"name")||p&&_.name!==O)&&i(_,"name",O),T=h(_),T.source||(T.source=m.join(typeof O=="string"?O:""))),g!==e?(E?!F&&g[x]&&(B=!0):delete g[x],B?g[x]=_:i(g,x,_)):B?g[x]=_:a(x,_)})(Function.prototype,"toString",function(){return o(this)&&d(this).source||u(this)})},4488:function(n,s,t){var e=t(7854),o=e.TypeError;n.exports=function(r){if(r==null)throw o("Can't call method on "+r);return r}},3505:function(n,s,t){var e=t(7854),o=Object.defineProperty;n.exports=function(r,i){try{o(e,r,{value:i,configurable:!0,writable:!0})}catch{e[r]=i}return i}},6200:function(n,s,t){var e=t(2309),o=t(9711),r=e("keys");n.exports=function(i){return r[i]||(r[i]=o(i))}},5465:function(n,s,t){var e=t(7854),o=t(3505),r="__core-js_shared__",i=e[r]||o(r,{});n.exports=i},2309:function(n,s,t){var e=t(1913),o=t(5465);(n.exports=function(r,i){return o[r]||(o[r]=i!==void 0?i:{})})("versions",[]).push({version:"3.19.1",mode:e?"pure":"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})},9303:function(n){var s=Math.ceil,t=Math.floor;n.exports=function(e){var o=+e;return o!==o||o===0?0:(o>0?t:s)(o)}},7466:function(n,s,t){var e=t(9303),o=Math.min;n.exports=function(r){return r>0?o(e(r),9007199254740991):0}},7908:function(n,s,t){var e=t(7854),o=t(4488),r=e.Object;n.exports=function(i){return r(o(i))}},7593:function(n,s,t){var e=t(7854),o=t(6916),r=t(111),i=t(2190),a=t(8173),u=t(2140),l=t(5112),p=e.TypeError,d=l("toPrimitive");n.exports=function(h,m){if(!r(h)||i(h))return h;var g,x=a(h,d);if(x){if(m===void 0&&(m="default"),g=o(x,h,m),!r(g)||i(g))return g;throw p("Can't convert object to primitive value")}return m===void 0&&(m="number"),u(h,m)}},4948:function(n,s,t){var e=t(7593),o=t(2190);n.exports=function(r){var i=e(r,"string");return o(i)?i:i+""}},1694:function(n,s,t){var e=t(5112),o=e("toStringTag"),r={};r[o]="z",n.exports=String(r)==="[object z]"},6330:function(n,s,t){var e=t(7854),o=e.String;n.exports=function(r){try{return o(r)}catch{return"Object"}}},9711:function(n,s,t){var e=t(1702),o=0,r=Math.random(),i=e(1 .toString);n.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+i(++o+r,36)}},3307:function(n,s,t){var e=t(133);n.exports=e&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},5112:function(n,s,t){var e=t(7854),o=t(2309),r=t(2597),i=t(9711),a=t(133),u=t(3307),l=o("wks"),p=e.Symbol,d=p&&p.for,h=u?p:p&&p.withoutSetter||i;n.exports=function(m){if(!r(l,m)||!a&&typeof l[m]!="string"){var g="Symbol."+m;a&&r(p,m)?l[m]=p[m]:l[m]=u&&d?d(g):h(g)}return l[m]}},8675:function(n,s,t){var e=t(260),o=t(6244),r=t(9303),i=e.aTypedArray,a=e.exportTypedArrayMethod;a("at",function(u){var l=i(this),p=o(l),d=r(u),h=d>=0?d:p+d;return h<0||h>=p?void 0:l[h]})},1118:function(n,s,t){var e=t(260),o=t(9671).findLastIndex,r=e.aTypedArray,i=e.exportTypedArrayMethod;i("findLastIndex",function(a){return o(r(this),a,arguments.length>1?arguments[1]:void 0)})},7380:function(n,s,t){var e=t(260),o=t(9671).findLast,r=e.aTypedArray,i=e.exportTypedArrayMethod;i("findLast",function(a){return o(r(this),a,arguments.length>1?arguments[1]:void 0)})},3744:function(n,s){s.Z=(t,e)=>{const o=t.__vccOpts||t;for(const[r,i]of e)o[r]=i;return o}},7203:function(n){n.exports=N}},U={};function A(n){var s=U[n];if(s!==void 0)return s.exports;var t=U[n]={exports:{}};return z[n](t,t.exports,A),t.exports}(function(){A.d=function(n,s){for(var t in s)A.o(s,t)&&!A.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:s[t]})}})(),function(){A.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){A.o=function(n,s){return Object.prototype.hasOwnProperty.call(n,s)}}(),function(){A.p=""}();var G={};return function(){if(A.d(G,{default:function(){return et}}),typeof window<"u"){var n=window.document.currentScript,s=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);s&&(A.p=s[1])}var t=A(7203);const e={class:"text-center font-sans w-96 mx-auto rounded-lg shadow-lg border-solid border-2 p-8"},o={key:0},r={key:0},i={key:1},a={class:"text-sm font-bold"},u={key:2,class:"text-sm"},l={class:"text-sm text-red-400"},p={class:"mt-8"},d=["src"],h=(0,t.createTextVNode)(" Your browser does not support the "),m=(0,t.createElementVNode)("code",null,"audio",-1),g=(0,t.createTextVNode)(" element. "),x=[h,m,g],_={key:0,class:"text-sm mt-2"};function k(b,c,f,v,S,w){const V=(0,t.resolveComponent)("icon-button"),ot=(0,t.resolveComponent)("submit-button");return(0,t.openBlock)(),(0,t.createElementBlock)("div",e,[f.isReadOnly?(0,t.createCommentVNode)("",!0):((0,t.openBlock)(),(0,t.createElementBlock)("section",o,[w.isAllowMic?((0,t.openBlock)(),(0,t.createElementBlock)("div",i,[S.recording?((0,t.openBlock)(),(0,t.createBlock)(V,{key:0,style:(0,t.normalizeStyle)({"border-color":f.buttonColor}),class:(0,t.normalizeClass)(w.buttonClass),name:"stop",onClick:w.toggleRecording},null,8,["style","class","onClick"])):((0,t.openBlock)(),(0,t.createBlock)(V,{key:1,style:(0,t.normalizeStyle)({"border-color":f.buttonColor}),class:(0,t.normalizeClass)(w.buttonClass),name:"mic",onClick:w.toggleRecording},null,8,["style","class","onClick"]))])):((0,t.openBlock)(),(0,t.createElementBlock)("div",r," Mic is not allowed. If you are using chrome, you can type URL: chrome://flags/#unsafely-treat-insecure-origin-as-secure and add this website url into the list. You need restart the browser to apply it. ")),(0,t.createElementVNode)("div",null,(0,t.toDisplayString)(w.recordedTime),1),(0,t.createElementVNode)("div",a,(0,t.toDisplayString)(S.successMessage),1),f.showInstruction?((0,t.openBlock)(),(0,t.createElementBlock)("div",u,(0,t.toDisplayString)(S.instructionMessage),1)):(0,t.createCommentVNode)("",!0),(0,t.createElementVNode)("div",l,(0,t.toDisplayString)(S.errorMessage),1)])),(0,t.createElementVNode)("figure",p,[(0,t.createElementVNode)("audio",{controls:"",src:S.recordedAudio,type:"audio/mpeg",class:"mx-auto"},x,8,d),f.showInstruction&&!f.isReadOnly?((0,t.openBlock)(),(0,t.createElementBlock)("figcaption",_,"Listen to your recording before submitting.")):(0,t.createCommentVNode)("",!0)]),f.isReadOnly?(0,t.createCommentVNode)("",!0):((0,t.openBlock)(),(0,t.createBlock)(ot,{key:1,onSubmit:w.sendData,color:f.buttonColor},null,8,["onSubmit","color"]))])}class T{constructor(c,f){this.backendEndpoint=c,this.headers=f}async postBackend(c){try{return!!(await fetch(this.backendEndpoint,{method:"POST",body:c,headers:this.headers})).ok}catch{return!1}}}A(8675),A(7380),A(1118);function E(b){return b?new Date(1e3*b).toISOString().substr(14,5):null}var B=class{constructor(b){this.bufferSize=b.bufferSize||4096,this.sampleRate=b.sampleRate,this.samples=b.samples}finish(){this._joinSamples();const b=new ArrayBuffer(44+2*this.samples.length),c=new DataView(b);this._writeString(c,0,"RIFF"),c.setUint32(4,36+2*this.samples.length,!0),this._writeString(c,8,"WAVE"),this._writeString(c,12,"fmt "),c.setUint32(16,16,!0),c.setUint16(20,1,!0),c.setUint16(22,1,!0),c.setUint32(24,this.sampleRate,!0),c.setUint32(28,4*this.sampleRate,!0),c.setUint16(32,4,!0),c.setUint16(34,16,!0),this._writeString(c,36,"data"),c.setUint32(40,2*this.samples.length,!0),this._floatTo16BitPCM(c,44,this.samples);const f=new Blob([c],{type:"audio/wav"});return{id:Date.now(),blob:f,url:URL.createObjectURL(f)}}_floatTo16BitPCM(b,c,f){for(let v=0;v<f.length;v++,c+=2){const S=Math.max(-1,Math.min(1,f[v]));b.setInt16(c,S<0?32768*S:32767*S,!0)}}_joinSamples(){const b=this.samples.length*this.bufferSize,c=new Float64Array(b);let f=0;for(let v=0;v<this.samples.length;v++){const S=this.samples[v];c.set(S,f),f+=S.length}this.samples=c}_writeString(b,c,f){for(let v=0;v<f.length;v++)b.setUint8(c+v,f.charCodeAt(v))}};class F{constructor(c={}){this.beforeRecording=c.beforeRecording,this.pauseRecording=c.pauseRecording,this.afterRecording=c.afterRecording,this.micFailed=c.micFailed,this.encoderOptions={bitRate:c.bitRate,sampleRate:c.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this.wavSamples=[],this._duration=0}start(){const c={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices||alert("mic is not allowed,pls chang setting"),navigator.mediaDevices.getUserMedia(c).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0}stop(){this.stream.getTracks().forEach(v=>v.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let c=null;c=new B({bufferSize:this.bufferSize,sampleRate:this.encoderOptions.sampleRate,samples:this.wavSamples}).finish(),this.wavSamples=[],c.duration=E(this.duration),this.records.push(c),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(c)}pause(){this.stream.getTracks().forEach(c=>c.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}recordList(){return this.records}lastRecord(){return this.records.slice(-1).pop()}_micCaptured(c){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(c),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=c,this.processor.onaudioprocess=f=>{const v=f.inputBuffer.getChannelData(0);let S=0;this.wavSamples.push(new Float32Array(v));for(let w=0;w<v.length;++w)S+=v[w]*v[w];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(S/v.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(c){this.micFailed&&this.micFailed(c)}}const O=["innerHTML"];function D(b,c,f,v,S,w){return(0,t.openBlock)(),(0,t.createElementBlock)("div",{innerHTML:S.icons[f.name]},null,8,O)}var j={props:{name:{type:String}},data(){return{icons:{download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/><path fill="none" d="M0 0h24v24H0z"/></svg>',mic:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>',stop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 6h12v12H6z"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'}}}},y=A(3744),M=(0,y.Z)(j,[["render",D]]);function J(b,c,f,v,S,w){return(0,t.openBlock)(),(0,t.createElementBlock)("button",{onClick:c[0]||(c[0]=(...V)=>w.clickButton&&w.clickButton(...V)),style:(0,t.normalizeStyle)({"background-color":f.color}),class:"p-3 mt-8 text-black rounded-md"}," Submit ",4)}var H={emits:["submit"],props:{color:{type:String}},methods:{clickButton(){this.$emit("submit")}}},Y=(0,y.Z)(H,[["render",J]]);const L="Click icon to start recording message.",C="Click icon again to stop recording.",W="Failed to use microphone. Please refresh and try again and permit the use of a microphone.",P="Successfully recorded message!",$="Successfully submitted audio message! Thank you!",Q="Error submitting audio message! Please try again later.";var Z={name:"AudioInput",props:{isReadOnly:{type:Boolean,default:!0},showInstruction:{type:Boolean,default:!0},time:{type:Number,default:1},bitRate:{type:Number,default:128},sampleRate:{type:Number,default:44100},backendEndpoint:{type:String},headers:{type:Object},buttonColor:{type:String,default:"green"},afterRecording:{type:Function},successfulUpload:{type:Function},failedUpload:{type:Function},customUpload:{type:Function,default:null}},components:{IconButton:M,SubmitButton:Y},data(){return{recording:!1,recordedAudio:null,recordedBlob:null,input:null,successMessage:null,errorMessage:null,instructionMessage:L}},computed:{isAllowMic(){return navigator.mediaDevices},buttonClass(){return"mx-auto h-14 w-14 fill-current text-black cursor-pointer rounded-50 border-2 m-4 p-2"},recordedTime(){var b,c;return this.time&&((b=this.input)==null?void 0:b.duration)>=60*this.time&&this.toggleRecording(),E((c=this.input)==null?void 0:c.duration)}},beforeUnmount(){this.recording&&this.stopinput()},methods:{toggleRecording(){this.recording=!this.recording,this.recording?this.initinput():this.stopRecording()},initinput(){this.input=new F({micFailed:this.micFailed,bitRate:this.bitRate,sampleRate:this.sampleRate}),this.input.start(),this.successMessage=null,this.errorMessage=null,this.instructionMessage=C,this.service=new T(this.backendEndpoint)},stopRecording(){this.input.stop();const b=this.input.recordList();this.recordedAudio=b[0].url,this.recordedBlob=b[0].blob,this.recordedAudio&&(this.successMessage=P,this.instructionMessage=null),this.afterRecording&&this.afterRecording()},async sendData(){if(!this.recordedBlob)return;let b=null;b=this.customUpload?await this.customUpload(this.recordedBlob):await this.service.postBackend(this.recordedBlob,this.headers),b?(this.errorMessage=null,this.successMessage=$,this.successfulUpload&&this.successfulUpload()):(this.successMessage=null,this.errorMessage=Q,this.failedUpload&&this.failedUpload())},micFailed(){this.recording=!1,this.instructionMessage=L,this.errorMessage=W}}},tt=(0,y.Z)(Z,[["render",k]]),et=tt}(),G=G.default,G}()})})(ct);const at=q,pt=st({__proto__:null,default:at},[q]);export{pt as v};
